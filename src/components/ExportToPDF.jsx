import jsPDF from 'jspdf'
import autoTable from 'jspdf-autotable'

const logoBase64 = 'data:image/png;base64,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'

export function exportMaterialsToPDF(materials, guests) {
  const doc = new jsPDF()

  const imgProps = doc.getImageProperties(logoBase64)
  const imgWidth = 30
  const imgHeight = (imgProps.height * imgWidth) / imgProps.width
  doc.addImage(logoBase64, 'PNG', 14, 10, imgWidth, imgHeight)

  doc.setFontSize(12)
  doc.text(`PAX: ${guests}`, 14, imgHeight + 20)

  autoTable(doc, {
    startY: imgHeight + 30,
    head: [['Material', 'Cantidad total']],
    body: materials.map(m => [m.material?.name || 'Desconocido', m.quantity]),
    theme: 'grid',
    styles: {
      halign: 'left',
      valign: 'middle'
    },
    headStyles: {
      fillColor: [0, 0, 0],
      textColor: [255, 255, 255],
      fontStyle: 'bold'
    }
  })

  doc.save('materiales_totales.pdf')
}